{
  "hash": "c82505167820e6600210b3829f08a4a6",
  "result": {
    "markdown": "---\ntitle: \"Graphic Design with ggplot2\"\nsubtitle: '<span style=\"font-size:1.75em;line-height:1.1;\">Group Projects:<br><span style=\"font-weight:500;\">\"Solutions\"</span></span>'\nauthor: \"<b style='color:#28a87d;'>Cédric Scherer</b> **//** rstudio::conf **//** July 2022\"\nformat:\n  revealjs:\n    theme: css/style.scss\n    footer: '**[Cédric Scherer](https::/cedricscherer.com) //** rstudio::conf **//** July 2022'\n    #'rstudio::conf(workshop = \"Graphic Design with ggplot2\", instructor = \"Cédric Scherer\")'\n    transition: fade\n    progress: true\n    multiplex: false\n    preview-links: true\n    scrollable: false\n    hide-inactive-cursor: true\n    highlight-style: printing\n    chalkboard:\n      theme: whiteboard\n      boardmarker-width: 4\n      buttons: true\n    pause: true\n    mainfont: Cabinet Grotesk\neditor: source\nknitr:\n  opts_chunk:\n    dev: \"ragg_png\"\n    retina: 1\n    dpi: 300\nexecute:\n  freeze: auto\n  cache: true\n  echo: true\n  fig-width: 5\n  fig-height: 6\n---\n\n\n## Group Projects\n\n::: question\n-   Form groups and work one of the following suggested projects:\n    - Carbon Footprint of Travel (OWID / UK.gov)\n    - Spending Before and During the Pandemic (JP Morgan Chase)\n    - Speed of Languages (Economist / Coupé et al.)\n    - US Drought Patterns (Drought Monitor)\n:::\n\n\n\n---\n\n\n![Graphic Source: [Our World in Data](https://ourworldindata.org/travel-carbon-footprint)](img/project-OWID.png){fig-align=\"center\" fig-alt=\"A very colorful bar chart by Our World in Data showing the carbon footrprint per passenger for differen types of mid- to long-distance transportation.\"}\n\n\n---\n\n::: {.cell hash='08_group_projects_solutions_cache/revealjs/owid-barchart_e3e1c81de47b60d73f3174a4b8d598c0'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndata <- read_csv(here::here(\"data\", \"carbon-footprint-travel.csv\"))\n\ndata %>% \n  mutate(\n    type = case_when(\n      str_detect(entity, \"car|Motorcycle\") ~ \"Private motorized transport\",\n      str_detect(entity, \"flight\") ~ \"Public air transport\",\n      str_detect(entity, \"Ferry\") ~ \"Public water transport\",\n      TRUE ~ \"Public land transport\"\n    )\n  ) %>% \n  ggplot(\n    aes(x = emissions, \n        y = forcats::fct_reorder(entity, emissions), \n        fill = type)\n  ) +\n  geom_col(orientation = \"y\", width = .8) +\n  geom_text(\n    aes(label = paste0(emissions, \"g\")),\n    nudge_x = 5,\n    hjust = 0,\n    size = 5,\n    family = \"Lato\",\n    color = \"grey40\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 250, by = 50), \n    labels = function(x) glue::glue(\"{x} g\"),\n    expand = c(0, 0),\n    limits = c(0, 285)\n  ) +\n  scale_fill_manual(\n    values = c(\"#dfb468\", \"#8fb9bf\", \"#28a87d\"), name = NULL\n  ) +\n  labs(\n    x = NULL, y = NULL,\n    title = \"Carbon footprint of travel per kilometer, 2018\", \n    subtitle = \"The carbon footprint of travel is measured in grams of carbon dioxide equivalents per passenger kilometer.\\nThis includes carbon dioxide, but also other greenhouse gases, and increased warming from aviation emissions at altitude.\", \n    caption = \"Source: UK Department for Business, Energy & Industrial Grenhouse gas reporting: conversion factors 2019.\\nNote: Data is based on official conversion factors used in UK reporting. These factors may vary slightly depending on the country.\\n\\nOriginal visualization by Hannah Ritchie, OurWorldInData.org | Makeover by Cédric Scherer\"\n  ) +\n  theme_minimal(base_size = 18, base_family = \"Cabinet Grotesk\") +\n  theme(\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.text = element_text(color = \"grey30\"),\n    axis.text.y = element_text(face = \"bold\"),\n    axis.text.x = element_blank(),\n    legend.position = c(.75, .2),\n    legend.text = element_text(size = 20),\n    legend.key.height = unit(2.6, \"lines\"),\n    plot.title = element_text(family = \"Cabinet Grotesk\", size = 40, color = \"grey30\", margin = margin(b = 10)),\n    plot.subtitle = element_text(size = 17, color = \"grey30\", margin = margin(b = 20)),\n    plot.title.position = \"plot\",\n    plot.caption = element_text(size = 14, hjust = 0, color = \"grey60\", margin = margin(t = 20), lineheight = 1.2),\n    plot.caption.position = \"plot\",\n    plot.margin = margin(15, 15, 15, 15)\n  )\n\nggsave(\"emissions.png\", width = 15, height = 10)\n```\n:::\n\n--- \n\n::: {.cell layout-align=\"center\" hash='08_group_projects_solutions_cache/revealjs/owid-barchart_3b4e07dcba8bc546a41cfd24fc5c4bc8'}\n::: {.cell-output-display}\n![](08_group_projects_solutions_files/figure-revealjs/owid-barchart-1.png){fig-align='center' width=4500}\n:::\n:::\n\n---\n\n\n\n![Graphic Source: [JPMorgan Chase Institute](https://www.jpmorganchase.com/institute/research/household-income-spending/initial-household-spending-response-to-covid-19-evidence-from-credit-card-transactions)](img/project-jpmorgan.png){fig-align=\"center\" fig-alt=\"A line plot by the JP Morgan Chase institute showing timeseries for 10 different categories before and after the National Emergency in 2020.\"}\n\n\n---\n\n::: {.cell hash='08_group_projects_solutions_cache/revealjs/jpmorgan-linechart_053de1f3de414c1f56317442154d1ac0'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gghighlight)\nlibrary(lubridate)\n\ninvisible(Sys.setlocale(\"LC_TIME\", \"C\"))\n\ndata <- read_csv(here::here(\"data\", \"spending-jpmorgan.csv\")) %>% \n  mutate(category = fct_inorder(category))\n\nlabel_df <-\n  tibble(\n    date = ymd(\"2020-03-13\"),\n    change = -60,\n    label = \"National emergency\\ndeclared March 13\",\n    category = factor(\"Groceries\", levels = levels(data$category))\n  )\n\nggplot(data, aes(date, change, color = category)) +\n    geom_point() +\n    geom_line(size = .8, alpha = .5) +\n    gghighlight(\n      use_direct_label = FALSE,\n      unhighlighted_params = list(color = \"grey80\", size = .5)\n    ) +\n    geom_vline(xintercept = ymd(\"2020-03-13\"), color = \"grey25\", linetype = \"dashed\") +\n    geom_hline(yintercept = 0, color = \"grey30\", size = .8) +\n    geom_area(alpha = .2) +\n    geom_line(size = 1.2) +\n    geom_point(size = 1.8) +\n    geom_text(\n      data = label_df,\n      aes(label = label),\n      color = \"grey25\",\n      family = \"Cabinet Grotesk\",\n      size = 4.1,\n      lineheight = .95,\n      hjust = 1.1\n    ) +\n    facet_wrap(~ category, ncol = 4, scales = \"free_x\") +\n    coord_cartesian(clip = \"off\") +\n    scale_x_date(\n      expand = c(.003, .003),\n      breaks = seq(ymd(\"2020-01-04\"), ymd(\"2020-04-11\"), length.out = 8),\n      date_labels = \"%b %d\"\n    ) +\n    scale_y_continuous(\n      breaks = seq(-80, 60, by = 20),\n      labels = glue::glue(\"{seq(-80, 60, by = 20)}%\")\n    ) +\n    rcartocolor::scale_color_carto_d(\n      palette = \"Prism\", guide = \"none\"\n    ) +\n    labs(\n      x = \"End of week\", y = NULL,\n      title = \"Year-over-year percent change in spending by essential category\",\n      caption = \"Source: JPMorgan Chase Institute | Makeover: Cédric Scherer\"\n    ) +\n    theme_minimal(\n      base_family = \"Cabinet Grotesk\", base_size = 14\n    ) +\n    theme(\n      plot.title = element_text(size = 22, margin = margin(b = 20)),\n      plot.title.position = \"plot\",\n      plot.caption = element_text(color = \"grey25\", size = 10, margin = margin(t = 0)),\n      plot.caption.position = \"plot\",\n      axis.text.x = element_text(size = 10),\n      axis.text.y = element_text(size = 12, margin = margin(l = 10, r = 7)),\n      axis.title.x = element_text(margin = margin(t = 15)),\n      axis.line.x = element_line(),\n      axis.ticks.x = element_line(color = \"black\"),\n      axis.ticks.length.x = unit(.5, \"lines\"),\n      strip.text = element_text(size = 15, face = \"bold\", margin = margin(b = 0)),\n      panel.grid.major.y = element_line(color = \"grey90\", size = .4),\n      panel.grid.major.x = element_blank(),\n      panel.grid.minor = element_blank(),\n      panel.spacing.x = unit(2.5, \"lines\"),\n      panel.spacing.y = unit(1.5, \"lines\"),\n      plot.margin = margin(20, 35, 20, 20)\n    )\n```\n:::\n\n--- \n\n::: {.cell layout-align=\"center\" hash='08_group_projects_solutions_cache/revealjs/jpmorgan-linechart_3e461b7eae2fa1939baf64922f0fdb7d'}\n::: {.cell-output-display}\n![](08_group_projects_solutions_files/figure-revealjs/jpmorgan-linechart-1.png){fig-align='center' width=4800}\n:::\n:::\n\n---\n\n\n![Graphic Source: [The Economist](https://www.economist.com/graphic-detail/2019/09/28/why-are-some-languages-spoken-faster-than-others)](img/project-speed-language.png){fig-align=\"center\" fig-alt=\"A area chart by The Economist showing the distriubtion of information and speech rates for different languages.\"}\n\n\n---\n\n::: {.cell hash='08_group_projects_solutions_cache/revealjs/economist-distributions_2a6d880ee82d5e370e5128b8ce6d8732'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggtext)\nlibrary(colorspace)\n\ndata <- \n  read_csv(here::here(\"data\", \"information-speech.csv\")) %>% \n  group_by(language) %>% \n  mutate(\n    avg_sr = mean(speech_rate),\n    avg_ir = mean(info_rate)\n  ) %>% \n  ungroup() %>% \n  mutate(\n    language = fct_reorder(language, avg_sr),\n    language_long = fct_reorder(language_long, avg_sr)\n  )\n\nsystemfonts::register_variant(\n  name = \"Cabinet Grotesk ExtraBold\",\n  family = \"Cabinet Grotesk\",\n  weight = \"ultrabold\"\n)\n\nsystemfonts::register_variant(\n  name = \"Cabinet Grotesk Medium\",\n  family = \"Cabinet Grotesk\",\n  weight = \"medium\"\n)\n\ndata_long <-\n  data %>% \n  dplyr::select(starts_with(\"lang\"), speech_rate, info_rate) %>%\n  ## normalize\n  mutate(\n    speech_rate = (speech_rate - min(speech_rate)) / (max(speech_rate) - min(speech_rate)),\n    info_rate = (info_rate - min(info_rate)) / (max(info_rate) - min(info_rate))\n  ) %>% \n  group_by(language) %>% \n  mutate(\n    avg_sr = median(speech_rate),\n    avg_ir = median(info_rate)\n  ) %>% \n  ungroup() %>% \n  pivot_longer(\n    cols = c(speech_rate, info_rate), \n    names_to = \"metric\", \n    values_to = \"rate\"\n  ) %>% \n  mutate(metric = factor(metric, levels = c(\"speech_rate\", \"info_rate\")))\n\ndata_labs <-\n  data.frame(\n    language_long = factor(\"Japanese\", levels = levels(data_long$language_long)),\n    label = c(\"Speak less quickly\", \"Convey less information\", \"Speak more quickly\", \"Convey more information\"),\n    metric = factor(c(\"speech_rate\", \"info_rate\", \"speech_rate\", \"info_rate\"), levels = levels(data_long$metric)),\n    rate = c(.01, .01, .99, .99),\n    vjust = c(-6.5, -4.7, -6.5, -4.7),\n    hjust = c(0, 0, 1, 1)\n  )\n\nggplot(data_long, aes(x = rate, y = language_long)) +\n  ## rain dots\n  geom_point(\n    aes(color = metric, color = after_scale(desaturate(lighten(color, .2), .4))),\n    position = position_nudge(y = -.06), shape = 1, size = .8, alpha = .35\n  ) +\n  ## distribution\n  ggdist::stat_halfeye(\n    aes(color = metric, fill = after_scale(color)), \n    slab_alpha = .35, .width = 0, trim = TRUE, shape = 21, point_colour = \"grey25\", stroke = 1.6, scale = .86\n  ) +\n  ## median line\n  geom_linerange(\n    aes(xmin = avg_sr, xmax = avg_ir), \n    size = .7, color = \"grey25\", stat = \"unique\"\n  ) +\n  ## median points\n  ggdist::stat_halfeye(\n    aes(color = metric), .width = c(0), slab_fill = NA\n  ) +\n  ## language labels\n  geom_text(\n    aes(label = language_long, x = .01), \n    position = position_nudge(y = .4), stat = \"unique\", hjust = 0,\n    family = \"Cabinet Grotesk ExtraBold\", color = \"grey25\", size = 5.5\n  ) +\n  geom_text(\n    data = data_labs, aes(label = label, color = metric, vjust = vjust, hjust = hjust),\n    family = \"Cabinet Grotesk Medium\", size = 5\n  ) +\n  coord_cartesian(xlim = c(0, 1), clip = \"off\") +\n  scale_x_continuous(\n    expand = c(0, 0), breaks = 0:5 / 5, guide = \"none\"\n  ) +\n  scale_y_discrete(\n    expand = c(.01, .01)\n  ) +\n  scale_color_manual(\n    values = c(\"#7d28a8\", \"#28a87d\"), guide = \"none\"\n  ) +\n  labs(\n    x = \"Normalized rates of <b style='color:#7d28a8;'>speech (syllables per second)</b> and <b style='color:#28a87d;'>information (bits per second)</b>\", \n    y = NULL,\n    title = \"Communicating fast doesn't necessarily mean communicating more\",\n    subtitle = \"Variation in speech and information rates across languages, shown as normalized rates for direct comparison.\\nWhile there are stark cross-linguistic differences in speech rates, information rates are more similar.\",\n    caption = \"Source: Coupé *et al.* 2019 *Science Advances* **5**(9). DOI: 10.1126/sciadv.aaw2594<br>Graphic: Cédric Scherer  •  Dots show the median rates for each language.\"\n  ) +\n  theme_minimal(base_size = 16, base_family = \"Cabinet Grotesk\") +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_line(size = .6, color = \"grey82\"),\n    axis.line.x = element_line(color = \"black\", size = .6),\n    axis.ticks.x = element_line(color = \"black\", size = .6),\n    axis.ticks.length.x = unit(.5, \"lines\"),\n    axis.title.x = element_markdown(margin = margin(t = 10)),\n    axis.title.x.top = element_markdown(),\n    axis.text.x = element_text(family = \"Tabular\", size = 14, color = \"grey25\"),\n    axis.text.y = element_blank(),\n    legend.position = \"top\",\n    plot.margin = margin(30, 35, 20, 35),\n    plot.title = element_text(family = \"Cabinet Grotesk ExtraBold\", size = 25),\n    plot.subtitle = element_text(margin = margin(b = 45)),\n    plot.caption = element_markdown(hjust = 0, margin = margin(t = 18), color = \"grey25\", lineheight = 1.15, size = 11)\n  )\n```\n:::\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='08_group_projects_solutions_cache/revealjs/economist-distributions_2e01ff6a71d1ab12b06b15cc676dbef4'}\n::: {.cell-output-display}\n![](08_group_projects_solutions_files/figure-revealjs/economist-distributions-1.png){fig-align='center' width=3450}\n:::\n:::\n\n::: footer\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}